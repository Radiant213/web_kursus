<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Data Siswa</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="p-4">
  <div class="container">
    <h2 class="mb-4 text-center">ðŸ“‹ Daftar Data Siswa</h2>
    <div class="text-end mb-3">
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal" id="tambahBtn">Tambah Data</button>
    </div>

    <table id="data-table" class="table table-bordered table-striped align-middle">
      <thead class="table-light">
        <tr>
          <th style="width: 60px">No</th>
          <th style="width: 140px">NISN</th>
          <th style="width: 220px">Nama</th>
          <th style="width: 140px">Kelas</th>
          <th>Alamat</th>
          <th style="width: 160px">Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="modal fade" id="myModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">Input Data Siswa</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="dataForm">
            <input type="hidden" id="editIndex" value="-1" />
            <div class="mb-3">
              <label for="nisn" class="form-label">NISN</label>
              <input type="text" id="nisn" class="form-control" required />
            </div>
            <div class="mb-3">
              <label for="nama" class="form-label">Nama</label>
              <input type="text" id="nama" class="form-control" required />
            </div>
            <div class="mb-3">
              <label for="kelas" class="form-label">Kelas</label>
              <select id="kelas" class="form-select" required>
                <option value="">Pilih Kelas</option>
                <option>X PPLG 1</option>
                <option>X PPLG 2</option>
                <option>X PPLG 3</option>
                <option>XI PPLG 1</option>
                <option>XI PPLG 2</option>
                <option>XII PPLG 1</option>
                <option>XII PPLG 2</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="alamat" class="form-label">Alamat</label>
              <textarea id="alamat" class="form-control" rows="2" required></textarea>
            </div>
            <div class="text-end">
              <button type="submit" class="btn btn-success">Simpan</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Array untuk menyimpan data siswa
    let dataSiswa = [];

    // Ambil elemen-elemen penting
    const dataForm = document.getElementById('dataForm');
    const dataTable = document.getElementById('data-table');
    const tbody = dataTable.querySelector('tbody');
    const myModal = new bootstrap.Modal(document.getElementById('myModal'));
    const modalTitle = document.getElementById('modalTitle');
    const tambahBtn = document.getElementById('tambahBtn');

    // Fungsi untuk mengatur ulang nomor urut
    function reindexTable() {
      const rows = tbody.querySelectorAll('tr');
      rows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
      });
    }

    // Fungsi untuk menampilkan data ke tabel
    function renderTable() {
      tbody.innerHTML = '';
      
      dataSiswa.forEach((siswa, index) => {
        const row = document.createElement('tr');
        
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${siswa.nisn}</td>
          <td>${siswa.nama}</td>
          <td>${siswa.kelas}</td>
          <td>${siswa.alamat}</td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-sm btn-warning edit-btn" data-index="${index}">Edit</button>
              <button class="btn btn-sm btn-danger delete-btn" data-index="${index}">Hapus</button>
            </div>
          </td>
        `;
        
        tbody.appendChild(row);
      });

      // Tambahkan event listener untuk tombol edit dan hapus
      document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = this.getAttribute('data-index');
          editData(index);
        });
      });

      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = this.getAttribute('data-index');
          deleteData(index);
        });
      });
    }

    // Fungsi untuk menambah data
    function addData(nisn, nama, kelas, alamat) {
      dataSiswa.push({ nisn, nama, kelas, alamat });
      renderTable();
    }

    // Fungsi untuk mengedit data
    function editData(index) {
      const siswa = dataSiswa[index];
      
      document.getElementById('editIndex').value = index;
      document.getElementById('nisn').value = siswa.nisn;
      document.getElementById('nama').value = siswa.nama;
      document.getElementById('kelas').value = siswa.kelas;
      document.getElementById('alamat').value = siswa.alamat;
      
      modalTitle.textContent = 'Edit Data Siswa';
      myModal.show();
    }

    // Fungsi untuk memperbarui data
    function updateData(index, nisn, nama, kelas, alamat) {
      dataSiswa[index] = { nisn, nama, kelas, alamat };
      renderTable();
    }

    // Fungsi untuk menghapus data
    function deleteData(index) {
      if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
        dataSiswa.splice(index, 1);
        renderTable();
        reindexTable();
      }
    }

    // Event listener untuk form submit
    dataForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const nisn = document.getElementById('nisn').value;
      const nama = document.getElementById('nama').value;
      const kelas = document.getElementById('kelas').value;
      const alamat = document.getElementById('alamat').value;
      const editIndex = document.getElementById('editIndex').value;
      
      if (editIndex === '-1') {
        // Tambah data baru
        addData(nisn, nama, kelas, alamat);
      } else {
        // Update data yang sudah ada
        updateData(parseInt(editIndex), nisn, nama, kelas, alamat);
      }
      
      // Reset form dan tutup modal
      dataForm.reset();
      document.getElementById('editIndex').value = '-1';
      myModal.hide();
    });

    // Event listener untuk tombol tambah data
    tambahBtn.addEventListener('click', function() {
      modalTitle.textContent = 'Input Data Siswa';
      document.getElementById('editIndex').value = '-1';
      dataForm.reset();
    });

    // Event listener ketika modal ditutup
    document.getElementById('myModal').addEventListener('hidden.bs.modal', function () {
      dataForm.reset();
      document.getElementById('editIndex').value = '-1';
    });

    // Inisialisasi tabel
    renderTable();
  </script>
</body>
</html>